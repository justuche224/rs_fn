import{u as O,r as n,j as e,B as l,t as P}from"./index-e8ay9PhV.js";import{A as R,a as H,b as I,c as W,d as Y,e as q}from"./alert-dialog-BL0pkcPu.js";import{C as x,c as h,d as f,a as p,b as j,e as C}from"./card-D0Ja0eCS.js";import{a as U}from"./wallets-B7reCd2E.js";import{m as V}from"./deposits-iHAa-Ezp.js";import{L as D}from"./loader-circle-uvu4pR17.js";import{A as z}from"./arrow-right-CUjQc4x0.js";import{T as G}from"./triangle-alert-BnwAlyDJ.js";import{C as M}from"./check-Mh_ZTpYM.js";function Q(i){n.useEffect(()=>{const c=o=>{if(i)return o.preventDefault(),o.returnValue="You have a deposit in progress. Are you sure you want to leave?",o.returnValue};return window.addEventListener("beforeunload",c),()=>window.removeEventListener("beforeunload",c)},[i])}const S=({currency:i})=>{switch(i){case"BTC":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-orange-500 flex items-center justify-center text-white font-bold",children:"₿"});case"ETH":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-purple-700 flex items-center justify-center text-white font-bold",children:"Ξ"});case"USDT":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-600 flex items-center justify-center text-white font-bold",children:"₮"});case"SOL":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold",children:"◎"});case"BNB":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold",children:"B"});case"LTC":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:"Ł"});default:return e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center",children:"?"})}},re=function(){const c=O(),[o,k]=n.useState([]),[A,N]=n.useState(!0),[g,y]=n.useState(null),[d,m]=n.useState("select-currency"),[t,F]=n.useState(null),[a,B]=n.useState(""),[b,w]=n.useState(!1),[E,u]=n.useState(!1);Q(d==="show-address"),n.useEffect(()=>{(async()=>{try{N(!0);const r=await U();k(r)}catch(r){y("Failed to load deposit methods. Please try again later."),console.error(r)}finally{N(!1)}})()},[]);const v=o.reduce((s,r)=>(s[r.currency]||(s[r.currency]=[]),s[r.currency].push(r),s),{}),T=s=>{const r=v[s];r&&r.length>0&&(F(r[0]),m("show-address"))},L=async()=>{if(!t||!a||isNaN(parseFloat(a))){y("Please enter a valid amount");return}try{w(!0),await V(t.id,t.currency,parseFloat(a)),m("confirmation")}catch(s){y("Failed to process your deposit. Please try again."),console.error(s)}finally{w(!1)}};return A?e.jsx("div",{className:"flex h-full min-h-96 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(D,{className:"mx-auto h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"mt-2 text-lg",children:"Loading deposit options..."})]})}):g?e.jsx("div",{className:"flex h-full min-h-96 items-center justify-center",children:e.jsxs(x,{className:"w-full max-w-md",children:[e.jsx(h,{className:"bg-red-50 text-red-700",children:e.jsx(f,{children:"Error"})}),e.jsx(p,{className:"pt-6",children:e.jsx("p",{children:g})}),e.jsx(j,{children:e.jsx(l,{onClick:()=>window.location.reload(),children:"Try Again"})})]})}):d==="select-currency"?e.jsxs("div",{className:"container py-8 mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Deposit Funds"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Select the cryptocurrency you wish to deposit:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.keys(v).map(s=>e.jsxs(x,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>T(s),children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(S,{currency:s}),e.jsx(f,{children:s})]})}),e.jsx(p,{children:e.jsxs(C,{children:["Deposit ",s," to your account"]})}),e.jsx(j,{className:"pt-0",children:e.jsxs(l,{variant:"ghost",className:"ml-auto",size:"sm",children:["Select ",e.jsx(z,{className:"ml-2 h-4 w-4"})]})})]},s))})]}):d==="show-address"&&t?e.jsxs("div",{className:"container py-8 mx-auto",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-6",children:["Deposit ",t.currency]}),e.jsxs(x,{className:"max-w-lg mx-auto",children:[e.jsxs(h,{children:[e.jsxs(f,{className:"flex items-center",children:[e.jsx(S,{currency:t.currency}),e.jsxs("span",{className:"ml-2",children:[t.currency," Deposit"]})]}),e.jsx(C,{children:"Send funds to the address below"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 border rounded-lg bg-gray-50",children:[t.qrCode&&e.jsx("div",{className:"mb-4 p-2 bg-white rounded",children:e.jsx("img",{src:t.qrCode,alt:`${t.currency} QR Code`,className:"w-48 h-48"})}),e.jsxs("div",{className:"flex items-center w-full",children:[e.jsx("input",{type:"text",value:t.address,readOnly:!0,className:"w-full p-2 border rounded bg-sidebar text-xs sm:text-sm font-mono"}),e.jsx(l,{variant:"outline",size:"sm",className:"ml-2 cursor-pointer",onClick:()=>{navigator.clipboard.writeText(t.address),P.success("Address copied to clipboard")},children:"Copy"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium",children:"Amount Sent in dollars"}),e.jsx("input",{id:"amount",type:"number",placeholder:"Enter amount in dollars",className:"w-full p-2 border rounded",value:a,onChange:s=>B(s.target.value),step:"0.00000001",min:"0"})]}),e.jsx("div",{className:"rounded-md bg-amber-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(G,{className:"h-5 w-5 text-amber-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Important Notes"}),e.jsx("div",{className:"mt-2 text-sm text-amber-700",children:e.jsxs("ul",{className:"list-disc space-y-1 pl-5",children:[e.jsxs("li",{children:["Send only ",t.currency," to this address"]}),e.jsx("li",{children:"Minimum confirmation required: 1 block"}),e.jsx("li",{children:"Please do not refresh or close this page until completion"})]})})]})]})})]}),e.jsxs(j,{className:"flex justify-between",children:[e.jsx(l,{variant:"outline",onClick:()=>{a&&parseFloat(a)>0?u(!0):m("select-currency")},children:"Back"}),e.jsx(l,{className:"cursor-pointer",onClick:L,disabled:!a||isNaN(parseFloat(a))||parseFloat(a)<=0||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"I have Sent the Funds"})]})]}),e.jsx(R,{open:E,onOpenChange:u,children:e.jsxs(H,{children:[e.jsxs(I,{children:[e.jsx(W,{children:"Are you sure?"}),e.jsx(Y,{children:"If you've already sent funds, going back will not cancel your deposit. Do you want to continue?"})]}),e.jsxs(q,{children:[e.jsx(l,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(l,{variant:"destructive",onClick:()=>{u(!1),m("select-currency")},children:"Yes, Go Back"})]})]})})]}):d==="confirmation"?e.jsx("div",{className:"container mx-auto py-8",children:e.jsxs(x,{className:"max-w-lg mx-auto",children:[e.jsxs(h,{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:e.jsx(M,{className:"h-6 w-6 text-green-600"})}),e.jsx(f,{className:"mt-4 text-xl",children:"Deposit Submitted"})]}),e.jsxs(p,{className:"text-center",children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Your deposit of ",a," ",t==null?void 0:t.currency," has been submitted and is pending approval."]}),e.jsx("p",{className:"text-gray-600",children:"Your balance will be updated as soon as the deposit is approved."})]}),e.jsxs(j,{className:"flex justify-center space-x-4",children:[e.jsx(l,{onClick:()=>c({to:"/dashboard/deposit-history"}),children:"View Deposit History"}),e.jsx(l,{variant:"outline",onClick:()=>c({to:"/dashboard"}),children:"Return to Dashboard"})]})]})}):null};export{re as component};
