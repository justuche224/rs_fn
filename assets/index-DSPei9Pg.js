import{s as U,j as e,c as T,L as C,B as S,a as F,r as l,D as M,v as $,w as O,x as W,y as X,C as D,$ as P,u as H,a0 as _,a1 as z}from"./index-Z5TVvw63.js";import{C as g,c as j,d as N,e as k,a as y,b as Y}from"./card-CvMxzrOD.js";import{C as R,a as G}from"./circle-arrow-down-BjMLAbDO.js";import{C as A}from"./credit-card-DLpg0s7a.js";import{T as B}from"./trending-up-B5xSamR4.js";import{P as K}from"./plus-Dfjdr8O5.js";import{g as q,a as J,b as Q}from"./stats-BJb0WM70.js";import{L as E}from"./loader-C_j3B3Ue.js";import{L}from"./loader-circle-DV2Lo5TK.js";import{A as V}from"./arrow-right-zUmcHAPe.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],ee=U("CircleArrowUp",Z);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],te=U("Ellipsis",se);function ae({heading:t,text:a,children:r,className:n}){return e.jsxs("div",{className:T("flex flex-col gap-1",n),children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:t}),a&&e.jsx("p",{className:"text-muted-foreground",children:a}),r]})}function re({children:t,className:a,...r}){return e.jsx("div",{className:T("grid items-start gap-4 sm:gap-8 px-2 sm:px-4",a),...r,children:t})}function ne({className:t,...a}){return e.jsxs(g,{className:T("",t),...a,children:[e.jsxs(j,{children:[e.jsx(N,{children:"Quick Actions"}),e.jsx(k,{children:"Perform common tasks with one click"})]}),e.jsxs(y,{className:"grid gap-4",children:[e.jsx(C,{to:"/dashboard/deposit",children:e.jsxs(S,{className:"w-full justify-start gap-2 cursor-pointer",children:[e.jsx(R,{className:"h-4 w-4"}),"Deposit Funds"]})}),e.jsx(C,{to:"/dashboard/withdraw",children:e.jsxs(S,{className:"w-full justify-start gap-2 cursor-pointer",children:[e.jsx(A,{className:"h-4 w-4"}),"Withdraw Funds"]})}),e.jsx(C,{to:"/dashboard/plans",children:e.jsxs(S,{className:"w-full justify-start gap-2 cursor-pointer",children:[e.jsx(B,{className:"h-4 w-4"}),"New Investment"]})}),e.jsx(C,{to:"/dashboard/account/wallet",children:e.jsxs(S,{className:"w-full justify-start gap-2 cursor-pointer",variant:"outline",children:[e.jsx(K,{className:"h-4 w-4"}),"Add Payment Method"]})})]})]})}function ie(){const{data:t,isPending:a,error:r}=F.useSession(),[n,h]=l.useState(null),[c,d]=l.useState(!0),[p,u]=l.useState("All");async function b(s){try{d(!0);const o=await q(s);h(o)}catch(o){console.error("Error fetching transaction history:",o)}finally{d(!1)}}l.useEffect(()=>{a||r||!t||b(t.user.id)},[t,a,r]);const w=s=>{const o=new Date(s),i=new Date,x=new Date(i);return x.setDate(x.getDate()-1),o.toDateString()===i.toDateString()?`Today, ${o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:o.toDateString()===x.toDateString()?`Yesterday, ${o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:`${o.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}, ${o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`},m=s=>{switch(s.type){case"deposit":return`Deposit (${s.currency})`;case"withdrawal":return`Withdrawal (${s.currency})`;case"investment":return`Investment (${s.currency})`;default:return`Transaction (${s.currency})`}},v=n==null?void 0:n.transactions.filter(s=>p==="All"?!0:s.type.toLowerCase()===p.toLowerCase());return e.jsxs(g,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Recent Activity"}),e.jsx(k,{children:"Your latest transactions and updates"})]}),e.jsxs(M,{children:[e.jsx($,{asChild:!0,children:e.jsxs(S,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(te,{className:"h-4 w-4"})]})}),e.jsxs(O,{align:"end",children:[e.jsx(W,{children:"Filter by"}),e.jsx(X,{}),e.jsx(D,{onClick:()=>u("All"),children:"All"}),e.jsx(D,{onClick:()=>u("Deposit"),children:"Deposits"}),e.jsx(D,{onClick:()=>u("Withdrawal"),children:"Withdrawals"}),e.jsx(D,{onClick:()=>u("Investment"),children:"Investments"})]})]})]}),e.jsx(y,{children:c?e.jsx("div",{className:"py-6 text-center text-muted-foreground grid place-content-center",children:e.jsx(E,{className:"animate-spin",size:50})}):!n||n.transactions.length===0?e.jsx("div",{className:"py-6 text-center text-muted-foreground",children:"No transaction history found"}):e.jsx("div",{className:"space-y-4",children:v==null?void 0:v.map(s=>e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`rounded-full p-2 ${s.type==="deposit"?"bg-primary/10":s.type==="withdrawal"?"bg-destructive/10":"bg-primary/10"}`,children:s.type==="deposit"?e.jsx(R,{className:"h-4 w-4 text-primary"}):s.type==="withdrawal"?e.jsx(ee,{className:"h-4 w-4 text-destructive"}):e.jsx(G,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:m(s)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:w(s.createdAt)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Status: ",s.status]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-medium ${s.type==="withdrawal"?"text-destructive":""}`,children:[s.type==="withdrawal"?"-":"+",parseFloat(s.amount).toLocaleString()," ",s.currency]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.type.charAt(0).toUpperCase()+s.type.slice(1)})]})]},s.id))})})]})}function le({userId:t}){var w,m,v,s,o;const[a,r]=l.useState({data:null,loading:!0,error:""}),[n,h]=l.useState({data:null,loading:!0,error:""}),[c,d]=l.useState({data:null,loading:!0,error:""});async function p(){try{r(f=>({...f,loading:!0,error:""}));const x=(await P()).reduce((f,I)=>f+I.totalAmount,0);r({data:x,loading:!1,error:""})}catch{r({data:null,loading:!1,error:"Failed to fetch withdrawals"})}}async function u(){try{d(f=>({...f,loading:!0,error:""}));const i=await Q(t),x=Object.values(i.totalInvestedAmountByCurrency).reduce((f,I)=>f+parseFloat(I),0);d({data:{...i,totalInvestmentAmount:x},loading:!1,error:""})}catch(i){d({data:null,loading:!1,error:i instanceof Error?i.message:"Error loading investment info"})}}async function b(){try{h(x=>({...x,loading:!0,error:""}));const i=await J(t);h({data:i,loading:!1,error:""})}catch(i){h({data:null,loading:!1,error:i instanceof Error?i.message:"Error loading referral info"})}}return l.useEffect(()=>{p(),b(),u()},[t]),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(g,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Total Investments"}),e.jsx(B,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:c.loading?e.jsx("div",{className:"text-2xl font-bold",children:e.jsx(E,{className:"animate-spin"})}):c.error?e.jsx("div",{className:"text-sm text-red-500",children:c.error}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((w=c.data)==null?void 0:w.totalInvestmentAmount.toFixed(2))||"0.00"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:((m=c.data)==null?void 0:m.totalCount)||0})," investment(s)"]})]})})]}),e.jsxs(g,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Total Withdrawals"}),e.jsx(A,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:a.loading?e.jsx("div",{className:"text-2xl font-bold",children:e.jsx(E,{className:"animate-spin"})}):a.error?e.jsx("div",{className:"text-sm text-red-500",children:a.error}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",((v=a.data)==null?void 0:v.toFixed(2))||"0.00"]})})})]}),e.jsxs(g,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"Referral Earnings"}),e.jsx(A,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:n.loading?e.jsx("div",{className:"text-2xl font-bold",children:e.jsx(E,{className:"animate-spin"})}):n.error?e.jsx("div",{className:"text-sm text-red-500",children:n.error}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((s=n.data)==null?void 0:s.totalRewards)||"0.00"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:((o=n.data)==null?void 0:o.totalReferrals)||0})," referral(s)"]})]})})]})]})}function oe(){const{data:t,isPending:a,error:r}=F.useSession(),[n,h]=l.useState(0),[c,d]=l.useState(!1),[p,u]=l.useState(""),b=H();return l.useEffect(()=>{async function w(){d(!0);try{const m=await _();h(m)}catch(m){u(m instanceof Error?m.message:"Failed to load balance")}finally{d(!1)}}w()},[]),r?null:e.jsxs(g,{className:"bg-gradient-to-r from-primary/10 via-primary/5 to-background border-primary/20",children:[e.jsxs(j,{children:[e.jsxs(N,{className:"text-xl flex items-center",children:["Welcome back,"," ",a?e.jsx(L,{className:"animate-spin my-auto ml-5",size:20}):(t==null?void 0:t.user.name)||"User"]}),e.jsx(k,{children:"Your portfolio is performing well. Here's a summary of your financial status."})]}),e.jsx(y,{children:p?e.jsx("div",{className:"text-3xl font-bold",children:p}):c?e.jsx("div",{className:"text-3xl font-bold",children:e.jsx(L,{className:"animate-spin",size:40})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:["$",new Intl.NumberFormat("en-US").format(n)]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Total balance across all accounts"})]})}),e.jsx(Y,{children:e.jsxs(S,{variant:"outline",className:"gap-1 cursor-pointer",onClick:()=>b({to:"/dashboard/all-history"}),children:["View portfolio details ",e.jsx(V,{className:"h-4 w-4"})]})})]})}function ce(){const t=l.useRef(null);return l.useEffect(()=>{const a=document.createElement("script");a.src="https://s3.tradingview.com/external-embedding/embed-widget-market-quotes.js",a.async=!0,a.innerHTML=JSON.stringify({width:"100%",height:400,symbolsGroups:[{name:"Crypto",symbols:[{name:"BINANCE:BTCUSDT",displayName:"Bitcoin"},{name:"BINANCE:ETHUSDT",displayName:"Ethereum"},{name:"BINANCE:XRPUSDT",displayName:"Ripple"},{name:"BINANCE:BNBUSDT",displayName:"Binance Coin"},{name:"BINANCE:DOGEUSDT",displayName:"Dogecoin"},{name:"BINANCE:SOLUSDT",displayName:"Solana"}]},{name:"Indices",originalName:"Indices",symbols:[{name:"FOREXCOM:SPXUSD",displayName:"S&P 500"},{name:"FOREXCOM:NSXUSD",displayName:"US 100"},{name:"FOREXCOM:DJI",displayName:"Dow 30"},{name:"INDEX:NKY",displayName:"Nikkei 225"},{name:"INDEX:DEU40",displayName:"DAX Index"},{name:"FOREXCOM:UKXGBP",displayName:"UK 100"}]}],showSymbolLogo:!0,colorTheme:"light",isTransparent:!1,locale:"en"});const r=document.querySelector(".tradingview-widget-container");return r&&(r.appendChild(a),t.current=a),()=>{t.current&&t.current.parentNode&&t.current.parentNode.removeChild(t.current)}},[]),e.jsxs(g,{className:"h-full",children:[e.jsx(j,{children:e.jsx(N,{children:"Market Data"})}),e.jsx(y,{className:"p-0",children:e.jsx("div",{className:"tradingview-widget-container h-[400px]",children:e.jsx("div",{className:"tradingview-widget-container__widget h-full"})})})]})}const ye=function(){const{user:a}=z.useLoaderData();return e.jsxs(re,{children:[e.jsx(ae,{heading:"Dashboard",text:"Welcome back to your financial overview."}),e.jsxs("div",{className:"grid gap-4 md:gap-6",children:[e.jsx(oe,{}),e.jsx(le,{userId:a.id}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-7 lg:grid-cols-12",children:[e.jsx("div",{className:"md:col-span-4 lg:col-span-8 overflow-hidden",children:e.jsx(ce,{})}),e.jsx("div",{className:"md:col-span-3 lg:col-span-4 overflow-hidden",children:e.jsx(ne,{className:"w-full"})})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e.jsx("div",{className:"overflow-hidden",children:e.jsx(ie,{})})})]})]})};export{ye as component};
