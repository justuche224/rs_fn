import{u as I,r as a,j as e,B as m,a8 as B,t as N,aH as H}from"./index-BebKO8iw.js";import{B as O}from"./badge-CzHjZMy7.js";import{T as $,a as q,b as w,c as l,d as Q,e as n}from"./table-PNZkqvvo.js";import{I as U}from"./input-BsAtIKt5.js";import{T as D,C as v}from"./checkbox-B4pi1EgH.js";import{A as M,a as G,b as J,c as K,d as V,e as W,f as X,g as Y}from"./alert-dialog-DkOS6-uz.js";import{S as Z}from"./search-BcFA-t0o.js";import{P as _}from"./plus-k_Rd8Syw.js";import{L as P}from"./loader-circle-DqFkOxna.js";import{S as ee}from"./square-pen-DxZZD93u.js";import"./index-Cr9R68zc.js";import"./check-BZKKekkh.js";function se(){const x=I(),[u,A]=a.useState([]),[c,j]=a.useState([]),[f,y]=a.useState(!0),[o,T]=a.useState(""),[t,i]=a.useState(new Set),[z,h]=a.useState(!1),[d,S]=a.useState(!1),g=async()=>{try{y(!0);const s=await B();A(s),j(s)}catch{N.error("Failed to fetch plans")}finally{y(!1)}};a.useEffect(()=>{g()},[]),a.useEffect(()=>{if(o.trim()==="")j(u);else{const s=o.toLowerCase();j(u.filter(r=>{var b,C;return((b=r.type)==null?void 0:b.toLowerCase().includes(s))||r.id.toLowerCase().includes(s)||((C=r.description)==null?void 0:C.toLowerCase().includes(s))}))}},[o,u]);const k=s=>{x({to:`/admin/plans/edit/${s}`})},L=async()=>{if(t.size!==0)try{S(!0),await H(Array.from(t)),N.success(`Successfully deleted ${t.size} plan(s)`),i(new Set),g()}catch{N.error("Failed to delete plans")}finally{S(!1),h(!1)}},R=s=>{const r=new Set(t);r.has(s)?r.delete(s):r.add(s),i(r)},E=()=>{t.size===c.length?i(new Set):i(new Set(c.map(s=>s.id)))},F=s=>s?new Date(s).toLocaleString():"N/A",p=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s);return e.jsxs("div",{className:"container mx-auto py-6 md:w-[90%] lg:w-[85%] px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Investment Plans Management"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(U,{type:"text",placeholder:"Search plans...",className:"pl-8 pr-4",value:o,onChange:s=>T(s.target.value)})]}),e.jsxs(m,{onClick:()=>x({to:"/admin/plans/new"}),className:"cursor-pointer",children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),"New Plan"]}),e.jsx(m,{onClick:g,disabled:f,className:"cursor-pointer",children:f?"Loading...":"Refresh"}),t.size>0&&e.jsxs(m,{variant:"destructive",onClick:()=>h(!0),className:"cursor-pointer",disabled:d,children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),"Delete (",t.size,")"]})]})]}),f?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(P,{className:"animate-spin",size:40})}):e.jsx("div",{className:"bg-sidebar rounded-lg shadow overflow-hidden",children:e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(w,{children:[e.jsx(l,{className:"w-12",children:e.jsx(v,{checked:t.size>0&&t.size===c.length,onCheckedChange:E,className:"cursor-pointer","aria-label":"Select all plans"})}),e.jsx(l,{children:"ID"}),e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Price"}),e.jsx(l,{children:"ROI Range"}),e.jsx(l,{children:"Duration"}),e.jsx(l,{children:"Created"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsx(Q,{children:c.length===0?e.jsx(w,{children:e.jsx(n,{colSpan:8,className:"text-center py-8",children:o?"No plans found matching your search":"No plans found"})}):c.map(s=>e.jsxs(w,{children:[e.jsx(n,{children:e.jsx(v,{checked:t.has(s.id),onCheckedChange:()=>R(s.id),className:"cursor-pointer","aria-label":`Select ${s.type||"plan"}`})}),e.jsxs(n,{className:"font-mono text-sm",children:[s.id.substring(0,8),"..."]}),e.jsx(n,{className:"font-medium",children:e.jsx(O,{variant:"outline",className:"bg-green-100 text-green-800",children:s.type})}),e.jsx(n,{children:p(s.price)}),e.jsxs(n,{children:[p(s.minRoiAmount)," -"," ",p(s.maxRoiAmount),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.percentage,"% return"]})]}),e.jsxs(n,{children:[s.duration," months",e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.commission,"% commission"]})]}),e.jsx(n,{children:F(s.createdAt)}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(m,{className:"cursor-pointer",variant:"outline",size:"sm",onClick:()=>k(s.id),children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(m,{variant:"destructive",size:"sm",className:"cursor-pointer",onClick:()=>{i(new Set([s.id])),h(!0)},children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},s.id))})]})}),e.jsx(M,{open:z,onOpenChange:s=>{h(s),!s&&!d&&i(new Set)},children:e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsx(K,{children:"Confirm Plan Deletion"}),e.jsx(V,{children:t.size>1?`Are you sure you want to delete ${t.size} plans? This action cannot be undone.`:"Are you sure you want to delete this plan? This action cannot be undone."})]}),e.jsxs(W,{children:[e.jsx(X,{disabled:d,children:"Cancel"}),e.jsx(Y,{onClick:s=>{s.preventDefault(),L()},disabled:d,className:"bg-red-600 text-white hover:bg-red-700",children:d?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}const ue=function(){return e.jsx(se,{})};export{ue as component};
