import{p as H,r,j as e,B as o,av as M,t as f,aw as P,ax as $}from"./index-BJX2Zmj2.js";import{B as t}from"./badge-0fc4Jg_Z.js";import{D as q,a as K,b as Q,c as X,d as Y,e as _}from"./dialog-9inh1Fj1.js";import{T as G,a as J,b as v,c,d as W,e as n}from"./table-QMatzzfJ.js";import{I as Z}from"./input-BxfUgAF-.js";import{T as k,C as z}from"./checkbox-C7vmAcWi.js";import{A as ee,a as se,b as ae,c as le,d as ie,e as re,f as te,g as ne}from"./alert-dialog-x71Zjlxb.js";import{S as ce}from"./search-MXxF8nlS.js";import{L as T}from"./loader-circle-BElWicZR.js";import{E as de}from"./eye-B9iDPZIm.js";import"./index-DAp99Zoo.js";import"./check-Ba8eI0ai.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],he=H("UserX",oe);function me(){const[g,V]=r.useState([]),[h,p]=r.useState([]),[N,w]=r.useState(!0),[m,E]=r.useState(""),[l,d]=r.useState(new Set),[a,D]=r.useState(null),[L,u]=r.useState(!1),[F,x]=r.useState(!1),[j,C]=r.useState(!1),b=async()=>{try{w(!0);const s=await M();V(s),p(s)}catch{f.error("Failed to fetch users")}finally{w(!1)}};r.useEffect(()=>{b()},[]),r.useEffect(()=>{if(m.trim()==="")p(g);else{const s=m.toLowerCase();p(g.filter(i=>{var A;return((A=i.name)==null?void 0:A.toLowerCase().includes(s))||i.email.toLowerCase().includes(s)||i.id.toLowerCase().includes(s)}))}},[m,g]);const B=async s=>{try{const i=await P(s);D(i),u(!0)}catch{f.error("Failed to fetch user details")}},I=async()=>{if(l.size!==0)try{C(!0),await $(Array.from(l)),f.success(`Successfully deleted ${l.size} user(s)`),d(new Set),b()}catch{f.error("Failed to delete users")}finally{C(!1),x(!1)}},O=s=>{const i=new Set(l);i.has(s)?i.delete(s):i.add(s),d(i)},R=()=>{l.size===h.length?d(new Set):d(new Set(h.map(s=>s.id)))},y=s=>new Date(s).toLocaleString(),S=s=>s==="ADMIN"?e.jsx(t,{className:"bg-purple-500",children:"Admin"}):e.jsx(t,{variant:"outline",children:"User"}),U=s=>s?e.jsx(t,{className:"bg-green-500",children:"Verified"}):e.jsx(t,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Unverified"});return e.jsxs("div",{className:"container mx-auto py-6 md:w-[90%] lg:w-[85%] px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"User Management"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(Z,{type:"text",placeholder:"Search users...",className:"pl-8 pr-4",value:m,onChange:s=>E(s.target.value)})]}),e.jsx(o,{onClick:b,disabled:N,className:"cursor-pointer",children:N?"Loading...":"Refresh"}),l.size>0&&e.jsxs(o,{variant:"destructive",onClick:()=>x(!0),className:"cursor-pointer",disabled:j,children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"Delete (",l.size,")"]})]})]}),N?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(T,{className:"animate-spin",size:40})}):e.jsx("div",{className:"bg-sidebar rounded-lg shadow overflow-hidden",children:e.jsxs(G,{children:[e.jsx(J,{children:e.jsxs(v,{children:[e.jsx(c,{className:"w-12",children:e.jsx(z,{checked:l.size>0&&l.size===h.length,onCheckedChange:R,className:"cursor-pointer","aria-label":"Select all users"})}),e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Email"}),e.jsx(c,{children:"Role"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"KYC"}),e.jsx(c,{children:"Created"}),e.jsx(c,{className:"text-right",children:"Actions"})]})}),e.jsx(W,{children:h.length===0?e.jsx(v,{children:e.jsx(n,{colSpan:8,className:"text-center py-8",children:m?"No users found matching your search":"No users found"})}):h.map(s=>e.jsxs(v,{children:[e.jsx(n,{children:e.jsx(z,{checked:l.has(s.id),onCheckedChange:()=>O(s.id),className:"cursor-pointer","aria-label":`Select ${s.name||"user"}`})}),e.jsx(n,{className:"font-medium",children:s.name||s.id.substring(0,8)+"..."}),e.jsx(n,{children:s.email}),e.jsx(n,{children:S(s.role)}),e.jsx(n,{children:U(s.emailVerified)}),e.jsx(n,{children:s.kycVerified?e.jsx(t,{className:"bg-green-500",children:"Verified"}):e.jsx(t,{variant:"outline",className:"bg-gray-100",children:"Not Verified"})}),e.jsx(n,{children:y(s.createdAt)}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(o,{className:"cursor-pointer",variant:"outline",size:"sm",onClick:()=>B(s.id),children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsxs(o,{variant:"destructive",size:"sm",className:"cursor-pointer",onClick:()=>{d(new Set([s.id])),x(!0)},children:[e.jsx(he,{className:"h-4 w-4 mr-1"}),"Delete"]})]})})]},s.id))})]})}),e.jsx(q,{open:L,onOpenChange:s=>{u(s),s||D(null)},children:e.jsxs(K,{className:"max-w-xl",children:[e.jsxs(Q,{children:[e.jsx(X,{children:"User Details"}),e.jsx(Y,{children:"Detailed information about this user."})]}),a&&e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"User ID:"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.id})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Role:"}),e.jsx("p",{children:S(a.role)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Name:"}),e.jsx("p",{className:"text-sm",children:a.name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Email:"}),e.jsx("p",{className:"text-sm",children:a.email})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Email Verification:"}),e.jsx("p",{children:U(a.emailVerified)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"KYC Status:"}),e.jsx("p",{children:a.kycVerified?e.jsx(t,{className:"bg-green-500",children:"Verified"}):e.jsx(t,{variant:"outline",className:"bg-gray-100",children:"Not Verified"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Phone:"}),e.jsx("p",{className:"text-sm",children:a.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"2FA Enabled:"}),e.jsx("p",{children:a.twoFactorEnabled?e.jsx(t,{className:"bg-green-500",children:"Enabled"}):e.jsx(t,{variant:"outline",children:"Disabled"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Created At:"}),e.jsx("p",{className:"text-sm",children:y(a.createdAt)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Last Updated:"}),e.jsx("p",{className:"text-sm",children:y(a.updatedAt)})]})]})}),e.jsxs(_,{children:[e.jsx(o,{variant:"outline",onClick:()=>u(!1),className:"cursor-pointer",children:"Close"}),e.jsxs(o,{variant:"destructive",onClick:()=>{a&&(u(!1),d(new Set([a.id])),x(!0))},className:"cursor-pointer",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"Delete User"]})]})]})}),e.jsx(ee,{open:F,onOpenChange:s=>{x(s),!s&&!j&&d(new Set)},children:e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(le,{children:"Confirm User Deletion"}),e.jsx(ie,{children:l.size>1?`Are you sure you want to delete ${l.size} users? This action cannot be undone.`:"Are you sure you want to delete this user? This action cannot be undone."})]}),e.jsxs(re,{children:[e.jsx(te,{disabled:j,children:"Cancel"}),e.jsx(ne,{onClick:s=>{s.preventDefault(),I()},disabled:j,className:"bg-red-600 text-white hover:bg-red-700",children:j?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}const Ce=me;export{Ce as component};
