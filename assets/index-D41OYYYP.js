import{u as J,r as n,j as e,B as h,au as K,t as j}from"./index-CoKmQzqE.js";import{C as b,c as y,d as v,a as C,b as T,e as Q}from"./card-CXmtqLj2.js";import{S as E,a as L,b as I,c as $,d as U}from"./select-DpggDoll.js";import{A as W,a as X,b as Z,c as ee,d as se,e as re,f as ae,g as te}from"./alert-dialog-BbcR-CNb.js";import{T as ne,a as le,b as R}from"./tabs-C2lG7du2.js";import{I as O}from"./input-BbanKK83.js";import{L as p}from"./label-D5XEXPb6.js";import{i as ie,c as ce}from"./transfers-CmAEWVJC.js";import{L as P}from"./loader-circle-DiYC9dVV.js";import{C as oe}from"./check-COnRAKLt.js";import{T as de}from"./triangle-alert-CaGie0c-.js";import{A as me}from"./arrow-right-JX1IhvZ0.js";import"./index-YJlYerc5.js";import"./index-Cf3RH1dd.js";import"./chevron-down-vbc2S0TJ.js";const xe=async(x,u,f,i)=>{if(!i&&u){const{success:c,error:o}=await ie(x,u,f);return c?{success:!0,message:"Transfer success"}:{success:!1,message:o??"Transfer failed"}}else if(i){const{success:c,error:o}=await ce(x,i,f);return c?{success:!0,message:"Transfer success"}:{success:!1,message:o??"Transfer failed"}}return{success:!1,message:"Invalid transfer type"}},ue=({currency:x})=>{switch(x){case"BTC":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-orange-500 flex items-center justify-center text-white font-bold",children:"₿"});case"ETH":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-purple-700 flex items-center justify-center text-white font-bold",children:"Ξ"});case"USDT":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-600 flex items-center justify-center text-white font-bold",children:"₮"});case"SOL":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold",children:"◎"});case"BNB":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold",children:"B"});case"LTC":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:"Ł"});default:return e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center",children:"?"})}},Be=function(){const u=J(),[f,i]=n.useState(!0),[c,o]=n.useState(!1),[w,V]=n.useState(null),[t,Y]=n.useState(null),[r,H]=n.useState("internal"),[a,S]=n.useState(""),[d,F]=n.useState(""),[l,A]=n.useState(""),[m,B]=n.useState(""),[M,g]=n.useState(!1),[q,D]=n.useState(!1),k=async()=>{i(!0);try{const s=await K();Y(s)}catch(s){V(s instanceof Error?s:new Error("An error occurred"))}finally{i(!1)}};n.useEffect(()=>{k()},[]);const _=async()=>{if(!a||!l||parseFloat(l)<=0||r==="internal"&&!d||r==="external"&&!m){j.error("Please fill in all required fields");return}if(t&&parseFloat(t[a])<parseFloat(l)){j.error(`Insufficient ${a} balance`);return}g(!0)},z=async()=>{g(!1),o(!0);try{const s=await xe(a,r==="internal"?d:null,parseFloat(l),r==="external"?m:void 0);s.success?(await k(),D(!0)):j.error(s.message||"Transfer failed")}catch(s){j.error("Failed to process transfer. Please try again."),console.error(s)}finally{o(!1)}},G=()=>{S(""),F(""),A(""),B(""),D(!1)};return f?e.jsx("div",{className:"flex h-full min-h-96 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"mx-auto h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"mt-2 text-lg",children:"Loading your balances..."})]})}):w?e.jsx("div",{className:"flex h-full min-h-96 items-center justify-center",children:e.jsxs(b,{className:"w-full max-w-md",children:[e.jsx(y,{className:"bg-red-50 text-red-700",children:e.jsx(v,{children:"Error"})}),e.jsx(C,{className:"pt-6",children:e.jsx("p",{children:w.message})}),e.jsx(T,{children:e.jsx(h,{onClick:()=>window.location.reload(),children:"Try Again"})})]})}):q?e.jsx("div",{className:"container mx-auto py-8",children:e.jsxs(b,{className:"max-w-lg mx-auto",children:[e.jsxs(y,{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:e.jsx(oe,{className:"h-6 w-6 text-green-600"})}),e.jsx(v,{className:"mt-4 text-xl",children:"Transfer Complete"})]}),e.jsxs(C,{className:"text-center",children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Your transfer of $",l," of ",a," has been completed successfully."]}),r==="internal"?e.jsxs("p",{className:"text-gray-600",children:["Funds have been transferred from ",a," to ",d,"."]}):e.jsxs("p",{className:"text-gray-600",children:["Funds have been sent to ",m,"."]})]}),e.jsxs(T,{className:"flex justify-center space-x-4",children:[e.jsx(h,{onClick:G,children:"Make Another Transfer"}),e.jsx(h,{variant:"outline",onClick:()=>u({to:"/dashboard"}),children:"Return to Dashboard"})]})]})}):e.jsxs("div",{className:"container py-8 mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Transfer Funds"}),e.jsxs(ne,{defaultValue:"internal",onValueChange:s=>H(s),children:[e.jsxs(le,{className:"mb-6 grid w-full grid-cols-2 max-w-md mx-auto ",children:[e.jsx(R,{value:"internal",className:"cursor-pointer",children:"Between My Balances"}),e.jsx(R,{value:"external",className:"cursor-pointer",children:"To Another User"})]}),e.jsxs(b,{className:"max-w-lg mx-auto",children:[e.jsxs(y,{children:[e.jsx(v,{children:r==="internal"?"Transfer Between Your Balances":"Transfer To Another User"}),e.jsx(Q,{children:r==="internal"?"Move funds between your cryptocurrency balances":"Send funds to another user via their email address"})]}),e.jsxs(C,{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-md bg-gray-50 p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Available Balances"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:t&&Object.entries(t).map(([s,N])=>e.jsxs("div",{className:"flex items-center p-2 rounded-md border",children:[e.jsx(ue,{currency:s}),e.jsxs("div",{className:"ml-2",children:[e.jsx("div",{className:"font-medium text-black",children:s}),e.jsxs("div",{className:"text-sm text-gray-600",children:["$",parseFloat(N).toFixed(2)]})]})]},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"from-currency",children:"From Currency"}),e.jsxs(E,{value:a,onValueChange:s=>S(s),children:[e.jsx(L,{id:"from-currency",children:e.jsx(I,{placeholder:"Select currency to transfer from"})}),e.jsx($,{children:t&&Object.entries(t).filter(([s,N])=>parseFloat(N)>0).map(([s])=>e.jsx(U,{value:s,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:s}),e.jsxs("span",{className:"text-sm text-gray-600",children:["$",t[s]]})]})},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"amount",children:"Amount (in USD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"$"}),e.jsx(O,{id:"amount",type:"number",placeholder:"0.00",className:"pl-8",value:l,onChange:s=>A(s.target.value),min:"0.01",step:"0.01"})]}),a&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Available: $",(t==null?void 0:t[a])||"0.00"]})]}),r==="internal"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"to-currency",children:"To Currency"}),e.jsxs(E,{value:d,onValueChange:s=>F(s),children:[e.jsx(L,{id:"to-currency",children:e.jsx(I,{placeholder:"Select currency to transfer to"})}),e.jsx($,{children:t&&Object.entries(t).filter(([s])=>s!==a).map(([s])=>e.jsx(U,{value:s,children:s},s))})]})]}),r==="external"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"recipient-email",children:"Recipient Email"}),e.jsx(O,{id:"recipient-email",type:"email",placeholder:"user@example.com",value:m,onChange:s=>B(s.target.value)})]}),e.jsx("div",{className:"rounded-md bg-amber-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(de,{className:"h-5 w-5 text-amber-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Important Notes"}),e.jsx("div",{className:"mt-2 text-sm text-amber-700",children:e.jsxs("ul",{className:"list-disc space-y-1 pl-5",children:[e.jsx("li",{children:"All transfers are final and cannot be reversed"}),r==="external"&&e.jsx("li",{children:"Please double-check the recipient email before confirming"}),e.jsx("li",{children:"Transfer amounts are in USD value"})]})})]})]})})]}),e.jsxs(T,{className:"flex justify-between",children:[e.jsx(h,{variant:"outline",onClick:()=>u({to:"/dashboard"}),children:"Cancel"}),e.jsx(h,{onClick:_,disabled:c||!a||!l||parseFloat(l)<=0||r==="internal"&&!d||r==="external"&&!m,children:c?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:["Continue ",e.jsx(me,{className:"ml-2 h-4 w-4"})]})})]})]})]}),e.jsx(W,{open:M,onOpenChange:g,children:e.jsxs(X,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Confirm Transfer"}),e.jsxs(se,{children:[r==="internal"?e.jsxs(e.Fragment,{children:["You are about to transfer $",l," from ",a," to"," ",d,"."]}):e.jsxs(e.Fragment,{children:["You are about to send $",l," of ",a," to"," ",m,"."]}),e.jsx("div",{className:"mt-2 font-semibold",children:"This action cannot be undone."})]})]}),e.jsxs(re,{children:[e.jsx(ae,{children:"Cancel"}),e.jsx(te,{onClick:z,children:"Confirm Transfer"})]})]})})]})};export{Be as component};
