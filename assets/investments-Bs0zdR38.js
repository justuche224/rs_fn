import{r as a,j as e,B as f,t as g}from"./index-Ci8F2kN6.js";import{B as h}from"./badge-CCPGKKbp.js";import{D as R,a as V,b as $,c as k,d as H,e as G}from"./dialog-DYuTcoaq.js";import{T as M,a as Q,b as N,c as i,d as q,e as l}from"./table-CMhteuM1.js";import{I as z}from"./input-BrDJe2Q8.js";import{S as J,a as K,b as W,c as X,d as c}from"./select-BnOj142m.js";import{b as Y,u as Z}from"./investments-Bwcv9f3g.js";import{L as v}from"./loader-circle-r0nk8heI.js";import{S as _}from"./search-DyDaJ7pD.js";import{F as ee}from"./filter-DlozNXj8.js";import"./index-uBAvylIJ.js";import"./index-CAnIM4vK.js";import"./chevron-down-BmMKDX8A.js";import"./check-Vbwjt8x8.js";function se(){const[o,E]=a.useState([]),[C,S]=a.useState([]),[d,y]=a.useState(!0),[t,I]=a.useState(null),[x,b]=a.useState(null),[T,w]=a.useState(!1),[r,F]=a.useState(null),[u,P]=a.useState(""),[m,U]=a.useState("ALL"),j=async()=>{try{y(!0);const s=await Y();E(s),S(s)}catch(s){console.error("Failed to fetch investments:",s),g.error("Failed to fetch investments data")}finally{y(!1)}};a.useEffect(()=>{let s=o;if(u){const n=u.toLowerCase();s=s.filter(L=>L.userName.toLowerCase().includes(n)||L.userEmail.toLowerCase().includes(n))}m!=="ALL"&&(s=s.filter(n=>n.status===m)),S(s)},[u,m,o]),a.useEffect(()=>{j()},[]);const B=async()=>{if(!(!t||!r)){b(t.id);try{await Z({investmentId:t.id,status:r}),g.success(`Investment status updated to ${r}`),j(),D()}catch(s){console.error("Failed to update investment status:",s),g.error(`Failed to update investment status to ${r}`)}finally{b(null)}}},D=()=>{I(null),F(null),w(!1)},O=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleString()}catch{return"Invalid Date"}},A=(s,n)=>`${s.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:8})} ${n}`,p=s=>{switch(s){case"ACTIVE":return e.jsx(h,{className:"bg-green-500 hover:bg-green-600",children:"Active"});case"COMPLETED":return e.jsx(h,{className:"bg-blue-500 hover:bg-blue-600",children:"Completed"});case"CANCELLED":return e.jsx(h,{variant:"destructive",children:"Cancelled"});case"PENDING":default:return e.jsx(h,{variant:"outline",className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:"Pending"})}};return e.jsxs("div",{className:"container mx-auto py-6 md:w-[90%] lg:w-[85%] px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Investments Administration"}),e.jsxs(f,{onClick:j,disabled:d,className:"cursor-pointer",children:[d?e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}):null,d?"Loading...":"Refresh"]})]}),e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("div",{className:"flex items-center gap-2 w-full md:w-1/2",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(_,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(z,{placeholder:"Search by user name or email",value:u,onChange:s=>P(s.target.value),className:"pl-8 w-full"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(J,{value:m,onValueChange:U,children:[e.jsx(K,{className:"w-[180px]",children:e.jsx(W,{placeholder:"Filter by Status"})}),e.jsxs(X,{children:[e.jsx(c,{value:"ALL",children:"All Statuses"}),e.jsx(c,{value:"PENDING",children:"Pending"}),e.jsx(c,{value:"ACTIVE",children:"Active"}),e.jsx(c,{value:"COMPLETED",children:"Completed"}),e.jsx(c,{value:"CANCELLED",children:"Cancelled"})]})]})]})]}),d?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(v,{className:"animate-spin",size:40})}):e.jsx("div",{className:"bg-sidebar rounded-lg shadow overflow-hidden border",children:e.jsxs(M,{children:[e.jsx(Q,{children:e.jsxs(N,{children:[e.jsx(i,{children:"User"}),e.jsx(i,{children:"Email"}),e.jsx(i,{children:"Plan Type"}),e.jsx(i,{children:"Amount"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Date Created"})]})}),e.jsx(q,{children:C.length===0?e.jsx(N,{children:e.jsx(l,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:o.length===0?"No investments found":"No investments match your filter criteria"})}):C.map(s=>e.jsxs(N,{children:[e.jsx(l,{className:"font-medium",children:s.userName||"N/A"}),e.jsx(l,{className:"text-sm text-muted-foreground",children:s.userEmail}),e.jsx(l,{className:"text-sm",children:s.planType}),e.jsx(l,{children:A(s.amount,s.currency)}),e.jsx(l,{children:p(s.status)}),e.jsx(l,{children:O(s.createdAt)})]},s.id))})]})}),e.jsx(R,{open:T,onOpenChange:w,children:e.jsxs(V,{children:[e.jsxs($,{children:[e.jsx(k,{children:"Confirm Status Change"}),e.jsx(H,{children:"Are you sure you want to change the status of this investment?"})]}),t&&e.jsxs("div",{className:"my-4 space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"User:"})," ",t.userName," (",t.userEmail,")"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Plan:"})," ",t.planType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," ",A(t.amount,t.currency)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Current Status:"})," ",p(t.status)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"New Status:"})," ",r&&p(r)]})]}),e.jsxs(G,{className:"flex justify-end gap-2",children:[e.jsx(f,{variant:"outline",onClick:D,disabled:!!x,className:"cursor-pointer",children:"Cancel"}),e.jsxs(f,{variant:r==="CANCELLED"?"destructive":"default",onClick:B,disabled:!t||!r||x===(t==null?void 0:t.id),className:"cursor-pointer",children:[x===(t==null?void 0:t.id)?e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirm ",r]})]})]})})]})}const pe=function(){return e.jsx(se,{})};export{pe as component};
