import{s as z,r as a,j as e,B as c,al as V,t as N}from"./index-Cn3qFwNA.js";import{B as p}from"./badge-Dd76ASPC.js";import{D as M,a as R,b as $,c as G,d as H,e as Q}from"./dialog-Cwz4VP_j.js";import{T as X,a as _,b,c as o,d as q,e as n}from"./table-CBY-Boh5.js";import{I as J}from"./input-BFG3t4H0.js";import{S as K,a as W,b as Y,c as Z,d}from"./select-Boe8a_aQ.js";import{b as ee,u as se}from"./investments-BZlybWI1.js";import{L as v}from"./loader-circle-aQEBN9NX.js";import{S as te}from"./search-CYNEWEWw.js";import{F as ae}from"./filter-BUm9G5Td.js";import{C as re}from"./check-D8ERr2HG.js";import{C as le}from"./circle-x-8P2JiNkW.js";import"./index-DjhMqF0M.js";import"./index-Cl_kZc5Z.js";import"./chevron-down-Biox4XNV.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ie=z("CircleCheckBig",ne);function ce(){const[u,F]=a.useState([]),[S,y]=a.useState([]),[m,E]=a.useState(!0),[t,w]=a.useState(null),[i,L]=a.useState(null),[P,f]=a.useState(!1),[r,D]=a.useState(null),[h,k]=a.useState(""),[x,U]=a.useState("ALL"),g=async()=>{try{E(!0);const s=await ee();F(s),y(s)}catch(s){console.error("Failed to fetch investments:",s),N.error("Failed to fetch investments data")}finally{E(!1)}};a.useEffect(()=>{let s=u;if(h){const l=h.toLowerCase();s=s.filter(T=>T.userName.toLowerCase().includes(l)||T.userEmail.toLowerCase().includes(l))}x!=="ALL"&&(s=s.filter(l=>l.status===x)),y(s)},[h,x,u]),a.useEffect(()=>{g()},[]);const B=async()=>{if(!(!t||!r)){L(t.id);try{await se({investmentId:t.id,status:r}),N.success(`Investment status updated to ${r}`),g(),A()}catch(s){console.error("Failed to update investment status:",s),N.error(`Failed to update investment status to ${r}`)}finally{L(null)}}},j=(s,l)=>{w(s),D(l),f(!0)},A=()=>{w(null),D(null),f(!1)},O=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleString()}catch{return"Invalid Date"}},I=(s,l)=>`${s.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:8})} ${l}`,C=s=>{switch(s){case"ACTIVE":return e.jsx(p,{className:"bg-green-500 hover:bg-green-600",children:"Active"});case"COMPLETED":return e.jsx(p,{className:"bg-blue-500 hover:bg-blue-600",children:"Completed"});case"CANCELLED":return e.jsx(p,{variant:"destructive",children:"Cancelled"});case"PENDING":default:return e.jsx(p,{variant:"outline",className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:"Pending"})}};return e.jsxs("div",{className:"container mx-auto py-6 md:w-[90%] lg:w-[85%] px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Investments Administration"}),e.jsxs(c,{onClick:g,disabled:m,className:"cursor-pointer",children:[m?e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}):null,m?"Loading...":"Refresh"]})]}),e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("div",{className:"flex items-center gap-2 w-full md:w-1/2",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(te,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(J,{placeholder:"Search by user name or email",value:h,onChange:s=>k(s.target.value),className:"pl-8 w-full"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(K,{value:x,onValueChange:U,children:[e.jsx(W,{className:"w-[180px]",children:e.jsx(Y,{placeholder:"Filter by Status"})}),e.jsxs(Z,{children:[e.jsx(d,{value:"ALL",children:"All Statuses"}),e.jsx(d,{value:"PENDING",children:"Pending"}),e.jsx(d,{value:"ACTIVE",children:"Active"}),e.jsx(d,{value:"COMPLETED",children:"Completed"}),e.jsx(d,{value:"CANCELLED",children:"Cancelled"})]})]})]})]}),m?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(v,{className:"animate-spin",size:40})}):e.jsx("div",{className:"bg-sidebar rounded-lg shadow overflow-hidden border",children:e.jsxs(X,{children:[e.jsx(_,{children:e.jsxs(b,{children:[e.jsx(o,{children:"User"}),e.jsx(o,{children:"Email"}),e.jsx(o,{children:"Plan Type"}),e.jsx(o,{children:"Amount"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Date Created"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(q,{children:S.length===0?e.jsx(b,{children:e.jsx(n,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:u.length===0?"No investments found":"No investments match your filter criteria"})}):S.map(s=>e.jsxs(b,{children:[e.jsx(n,{className:"font-medium",children:s.userName||"N/A"}),e.jsx(n,{className:"text-sm text-muted-foreground",children:s.userEmail}),e.jsx(n,{className:"text-sm",children:s.planType}),e.jsx(n,{children:I(s.amount,s.currency)}),e.jsx(n,{children:C(s.status)}),e.jsx(n,{children:O(s.createdAt)}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[s.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 cursor-pointer",onClick:()=>j(s,"ACTIVE"),disabled:i===s.id,children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),"Activate"]}),e.jsxs(c,{variant:"destructive",size:"sm",className:"cursor-pointer",onClick:()=>j(s,"CANCELLED"),disabled:i===s.id,children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),"Cancel"]})]}),s.status==="ACTIVE"&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{variant:"default",size:"sm",className:"bg-blue-600 hover:bg-blue-700 cursor-pointer",onClick:()=>j(s,"COMPLETED"),disabled:i===s.id,children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Complete"]}),e.jsxs(c,{variant:"destructive",size:"sm",className:"cursor-pointer",onClick:()=>j(s,"CANCELLED"),disabled:i===s.id,children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Cancel"]})]}),(s.status==="COMPLETED"||s.status==="CANCELLED")&&e.jsx("span",{className:"text-xs text-muted-foreground italic pr-4",children:"No actions"})]})})]},s.id))})]})}),e.jsx(M,{open:P,onOpenChange:f,children:e.jsxs(R,{children:[e.jsxs($,{children:[e.jsx(G,{children:"Confirm Status Change"}),e.jsx(H,{children:"Are you sure you want to change the status of this investment?"})]}),t&&e.jsxs("div",{className:"my-4 space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"User:"})," ",t.userName," (",t.userEmail,")"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Plan:"})," ",t.planType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," ",I(t.amount,t.currency)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Current Status:"})," ",C(t.status)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"New Status:"})," ",r&&C(r)]})]}),e.jsxs(Q,{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"outline",onClick:A,disabled:!!i,className:"cursor-pointer",children:"Cancel"}),e.jsxs(c,{variant:r==="CANCELLED"?"destructive":"default",onClick:B,disabled:!t||!r||i===(t==null?void 0:t.id),className:"cursor-pointer",children:[i===(t==null?void 0:t.id)?e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirm ",r]})]})]})})]})}const ye=function(){return e.jsx(ce,{})};export{ye as component};
